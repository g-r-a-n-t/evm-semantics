module INVARIANT-SPEC 
    imports VERIFICATION

    claim

    <kevm>
        <k> #execute => #halt </k>
        <exit-code> 1 </exit-code>
        <mode> NORMAL </mode>
        <schedule> ISTANBUL </schedule>

        <ethereum>
            <evm>
                <output> _ => #buf(0, 0) </output>
                <statusCode> _ => EVMC_SUCCESS </statusCode>
                <callStack> _ </callStack>
                <interimStates> _ </interimStates>
                <touchedAccounts> _ => ?_ </touchedAccounts>

                <callState>
                    // todo: gen this part
                    <program> #parseByteStack("0x6100ed6060356100df604035602035600035916040519182156100f7575b6100d6906100c4849560406100e8960180156100ef575b60400160405261004b87610046610100565b610486565b6100b561007361009161005c610469565b99610065610469565b506100788b61007383610130565b6104d9565b610080610469565b92839161008b610469565b50610130565b61009b8184610277565b6100a58186610284565b6100af81886102c6565b8a6102c6565b6100be87610308565b51610267565b6100cd85610344565b5160f81c610267565b6100df8361036a565b5160801c610267565b61036a565b005b506060610034565b6060925061001d565b610108610390565b605f8101908115610127575b6040820160405281526040602082015290565b60609150610114565b6040908151801561025f575b608001908115610256575b82820183526101568282610486565b602080910151838051801561024e575b01908115610245575b84820185526000825282820152835190811561023c575b81610195918682018752610486565b8351928315610233575b836101af91608082018752610486565b80848401926000905b6002821061021c57505081038085036101f6575b50505081519182156101ed575b6101ea9183916080830190526104d9565b90565b606092506101d9565b600160001991860360031b610100031b01908119905116908251161790523880806101cc565b9093928180826001935187520194019401906101b8565b6060935061019f565b60609150610186565b6060915061016f565b506060610166565b60609150610147565b50606061013c565b141560011461027257565b600080fd5b9061028190610308565b52565b906102ad604080805180156102be575b01928382528181519480156102b6575b018252016103b4565b019060f81b9052565b5060606102a4565b506060610294565b906102ef60408080518015610300575b01928382528181519480156102f8575b01825201610417565b019060801b9052565b5060606102e6565b5060606102d6565b6103306040808051801561033c575b0192838252818151948015610334575b01825201610440565b0190565b506060610327565b506060610317565b610330604080805180156102be5701928382528181519480156102b657018252016103b4565b610330604080805180156103005701928382528181519480156102f85701825201610417565b6000906040518015806001146103ac57156103a85750565b9150565b506060925050565b90600091805160018101600160208401510181109283600114610411575050506000146103dd57565b6040518015610409575b80516001600160e01b0316634e487b7160e01b17815260016004820152602490fd5b5060606103e7565b52925050565b90600091805160108101600160208401510181109283600114610411575050506000146103dd57565b90600091805160208101600160208401510181109283600114610411575050506000146103dd57565b60405190811561047d575b60808201604052565b60609150610474565b8060005b600281106104c357508103806040036104a257505050565b60016000199160400360031b610100031b0190811990511690825116179052565b825184526020938401939092019160010161048a565b8060005b6004811061051657508103806080036104f557505050565b60016000199160800360031b610100031b0190811990511690825116179052565b82518452602093840193909201916001016104dd56") </program>
                    <jumpDests> #computeValidJumpDests(#parseByteStack("0x6100ed6060356100df604035602035600035916040519182156100f7575b6100d6906100c4849560406100e8960180156100ef575b60400160405261004b87610046610100565b610486565b6100b561007361009161005c610469565b99610065610469565b506100788b61007383610130565b6104d9565b610080610469565b92839161008b610469565b50610130565b61009b8184610277565b6100a58186610284565b6100af81886102c6565b8a6102c6565b6100be87610308565b51610267565b6100cd85610344565b5160f81c610267565b6100df8361036a565b5160801c610267565b61036a565b005b506060610034565b6060925061001d565b610108610390565b605f8101908115610127575b6040820160405281526040602082015290565b60609150610114565b6040908151801561025f575b608001908115610256575b82820183526101568282610486565b602080910151838051801561024e575b01908115610245575b84820185526000825282820152835190811561023c575b81610195918682018752610486565b8351928315610233575b836101af91608082018752610486565b80848401926000905b6002821061021c57505081038085036101f6575b50505081519182156101ed575b6101ea9183916080830190526104d9565b90565b606092506101d9565b600160001991860360031b610100031b01908119905116908251161790523880806101cc565b9093928180826001935187520194019401906101b8565b6060935061019f565b60609150610186565b6060915061016f565b506060610166565b60609150610147565b50606061013c565b141560011461027257565b600080fd5b9061028190610308565b52565b906102ad604080805180156102be575b01928382528181519480156102b6575b018252016103b4565b019060f81b9052565b5060606102a4565b506060610294565b906102ef60408080518015610300575b01928382528181519480156102f8575b01825201610417565b019060801b9052565b5060606102e6565b5060606102d6565b6103306040808051801561033c575b0192838252818151948015610334575b01825201610440565b0190565b506060610327565b506060610317565b610330604080805180156102be5701928382528181519480156102b657018252016103b4565b610330604080805180156103005701928382528181519480156102f85701825201610417565b6000906040518015806001146103ac57156103a85750565b9150565b506060925050565b90600091805160018101600160208401510181109283600114610411575050506000146103dd57565b6040518015610409575b80516001600160e01b0316634e487b7160e01b17815260016004820152602490fd5b5060606103e7565b52925050565b90600091805160108101600160208401510181109283600114610411575050506000146103dd57565b90600091805160208101600160208401510181109283600114610411575050506000146103dd57565b60405190811561047d575b60808201604052565b60609150610474565b8060005b600281106104c357508103806040036104a257505050565b60016000199160400360031b610100031b0190811990511690825116179052565b825184526020938401939092019160010161048a565b8060005b6004811061051657508103806080036104f557505050565b60016000199160800360031b610100031b0190811990511690825116179052565b82518452602093840193909201916001016104dd56")) </jumpDests>

                    <id> ACCT_ID </id> // contract owner
                    <caller> CALLER_ID </caller> // who called this contract; in the beginning, origin // msg.sender

                    // todo: gen this part
                    <callData> #buf(32, ARG_0) +Bytes #buf(32, ARG_1) +Bytes #buf(32, ARG_2) +Bytes #buf(32, ARG_3) </callData>

                    <callValue> 0 </callValue>
                    <wordStack> .WordStack => ?_ </wordStack>
                    <localMem> .Bytes => ?_ </localMem>
                    <pc> 0 => ?_ </pc>
                    <gas> #gas(_VGAS) => ?_ </gas>
                    <memoryUsed> 0 => ?_ </memoryUsed>
                    <callGas> _ => ?_ </callGas>

                    <static> false </static> // NOTE: non-static call
                    <callDepth> CALL_DEPTH </callDepth>
                </callState>

                <substate>
                    <selfDestruct> _ </selfDestruct>
                    <log> _ </log>
                    <refund> _ </refund>
                    <accessedAccounts> _ => ?_ </accessedAccounts>
                    <accessedStorage> _ => ?_ </accessedStorage>
                </substate>

                <gasPrice> _ </gasPrice>
                <origin> ORIGIN_ID </origin>

                <blockhashes> _ </blockhashes>
                <block>
                    <previousHash> _ </previousHash>
                    <ommersHash> _ </ommersHash>
                    <coinbase> _ </coinbase>
                    <stateRoot> _ </stateRoot>
                    <transactionsRoot> _ </transactionsRoot>
                    <receiptsRoot> _ </receiptsRoot>
                    <logsBloom> _ </logsBloom>
                    <difficulty> _ </difficulty>
                    <number> _ </number>
                    <gasLimit> _ </gasLimit>
                    <gasUsed> _ </gasUsed>
                    <timestamp> _ </timestamp>
                    <extraData> _ </extraData>
                    <mixHash> _ </mixHash>
                    <blockNonce> _ </blockNonce>
                    <ommerBlockHeaders> _ </ommerBlockHeaders>
                    <baseFee> _ </baseFee>
                </block>
            </evm>

            <network>
                <chainID> _ </chainID>

                <activeAccounts> SetItem(ACCT_ID) _:Set </activeAccounts>

                <accounts>
                    <account>
                        <acctID> ACCT_ID </acctID>
                        <balance> _ </balance>
                        <code> #parseByteStack("0x6100ed6060356100df604035602035600035916040519182156100f7575b6100d6906100c4849560406100e8960180156100ef575b60400160405261004b87610046610100565b610486565b6100b561007361009161005c610469565b99610065610469565b506100788b61007383610130565b6104d9565b610080610469565b92839161008b610469565b50610130565b61009b8184610277565b6100a58186610284565b6100af81886102c6565b8a6102c6565b6100be87610308565b51610267565b6100cd85610344565b5160f81c610267565b6100df8361036a565b5160801c610267565b61036a565b005b506060610034565b6060925061001d565b610108610390565b605f8101908115610127575b6040820160405281526040602082015290565b60609150610114565b6040908151801561025f575b608001908115610256575b82820183526101568282610486565b602080910151838051801561024e575b01908115610245575b84820185526000825282820152835190811561023c575b81610195918682018752610486565b8351928315610233575b836101af91608082018752610486565b80848401926000905b6002821061021c57505081038085036101f6575b50505081519182156101ed575b6101ea9183916080830190526104d9565b90565b606092506101d9565b600160001991860360031b610100031b01908119905116908251161790523880806101cc565b9093928180826001935187520194019401906101b8565b6060935061019f565b60609150610186565b6060915061016f565b506060610166565b60609150610147565b50606061013c565b141560011461027257565b600080fd5b9061028190610308565b52565b906102ad604080805180156102be575b01928382528181519480156102b6575b018252016103b4565b019060f81b9052565b5060606102a4565b506060610294565b906102ef60408080518015610300575b01928382528181519480156102f8575b01825201610417565b019060801b9052565b5060606102e6565b5060606102d6565b6103306040808051801561033c575b0192838252818151948015610334575b01825201610440565b0190565b506060610327565b506060610317565b610330604080805180156102be5701928382528181519480156102b657018252016103b4565b610330604080805180156103005701928382528181519480156102f85701825201610417565b6000906040518015806001146103ac57156103a85750565b9150565b506060925050565b90600091805160018101600160208401510181109283600114610411575050506000146103dd57565b6040518015610409575b80516001600160e01b0316634e487b7160e01b17815260016004820152602490fd5b5060606103e7565b52925050565b90600091805160108101600160208401510181109283600114610411575050506000146103dd57565b90600091805160208101600160208401510181109283600114610411575050506000146103dd57565b60405190811561047d575b60808201604052565b60609150610474565b8060005b600281106104c357508103806040036104a257505050565b60016000199160400360031b610100031b0190811990511690825116179052565b825184526020938401939092019160010161048a565b8060005b6004811061051657508103806080036104f557505050565b60016000199160800360031b610100031b0190811990511690825116179052565b82518452602093840193909201916001016104dd56") </code>
                        <storage> _ </storage>
                        <origStorage> _ </origStorage>
                        <nonce> _ </nonce>
                    </account>
                </accounts>

                <txOrder> _ </txOrder>
                <txPending> _ </txPending>
                <messages> _ </messages>
            </network>
        </ethereum>
    </kevm>

    requires 0 <=Int ACCT_ID    andBool ACCT_ID    <Int (2 ^Int 160)
        andBool 0  <=Int CALLER_ID  andBool CALLER_ID  <Int (2 ^Int 160)
        andBool 0  <=Int ORIGIN_ID  andBool ORIGIN_ID  <Int (2 ^Int 160)
        andBool 0  <=Int CALL_DEPTH andBool CALL_DEPTH <Int 1024
        andBool 0 <=Int ARG_0 andBool ARG_0 <Int (2 ^Int 256)
andBool 0 <=Int ARG_1 andBool ARG_1 <Int (2 ^Int 8)
andBool 0 <=Int ARG_2 andBool ARG_2 <Int (2 ^Int 128)
andBool 0 <=Int ARG_3 andBool ARG_3 <Int (2 ^Int 128)

endmodule

