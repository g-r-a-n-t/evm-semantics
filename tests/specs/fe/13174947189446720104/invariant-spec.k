module INVARIANT-SPEC 
    imports VERIFICATION

    claim

    <kevm>
        <k> #execute => #halt </k>
        <exit-code> 1 </exit-code>
        <mode> NORMAL </mode>
        <schedule> ISTANBUL </schedule>

        <ethereum>
            <evm>
                <output> _ => #buf(0, 0) </output>
                <statusCode> _ => EVMC_SUCCESS </statusCode>
                <callStack> _ </callStack>
                <interimStates> _ </interimStates>
                <touchedAccounts> _ => ?_ </touchedAccounts>

                <callState>
                    // todo: gen this part
                    <program> #parseByteStack("0x60003560409081518015610113575b82808201801561010b575b0183526100246102f2565b602090818101908115610102575b8582018652815260019485838301528184936000905b600282106100ed576100c6886100bd898989898f8a83038083036100c8575b50505050506100b86100946100b261007d6103a3565b936100866103a3565b50610099856100948361011b565b6103c0565b6100a16103a3565b9283916100ac6103a3565b50610164565b846102b0565b610316565b5160f81c6101f4565b005b600019920360031b610100031b01908119905116908251161790528480808080610067565b84518652948501949384019390880190610048565b60609150610032565b506060610019565b50606061000e565b61013490604051801561015c575b608001604052610204565b604051908115610153575b8161015091608082016040526103c0565b90565b6060915061013f565b506060610129565b61017c90604051801561015c57608001604052610204565b6040519081156101eb575b6080820160405280829160005b600481106101d557508103806080036101ae575b50505090565b60016000199160800360031b610100031b01908119905116908251161790523880806101a8565b8251845260209384019390920191600101610194565b60609150610187565b14156001146101ff57565b600080fd5b604080519182156102a7575b60209082840183526102228482610413565b0151818051801561029f575b01908115610296575b8282018352600082526020820152815190811561028d575b8161025e918482018552610413565b8151918215610284575b61027c838095608061015096018452610413565b830190610413565b60609250610268565b6060915061024f565b60609150610237565b50606061022e565b60609250610210565b906102d9604080805180156102ea575b01928382528181519480156102e2575b01825201610340565b019060f81b9052565b5060606102d0565b5060606102c0565b60009060405180158060011461030e571561030a5750565b9150565b506060925050565b61033c604080805180156102ea5701928382528181519480156102e25701825201610340565b0190565b9060009180516001810160016020840151018110928360011461039d5750505060001461036957565b6040518015610395575b80516001600160e01b0316634e487b7160e01b17815260016004820152602490fd5b506060610373565b52925050565b6040519081156103b7575b60808201604052565b606091506103ae565b8060005b600481106103fd57508103806080036103dc57505050565b60016000199160800360031b610100031b0190811990511690825116179052565b82518452602093840193909201916001016103c4565b8060005b60028110610450575081038060400361042f57505050565b60016000199160400360031b610100031b0190811990511690825116179052565b825184526020938401939092019160010161041756") </program>
                    <jumpDests> #computeValidJumpDests(#parseByteStack("0x60003560409081518015610113575b82808201801561010b575b0183526100246102f2565b602090818101908115610102575b8582018652815260019485838301528184936000905b600282106100ed576100c6886100bd898989898f8a83038083036100c8575b50505050506100b86100946100b261007d6103a3565b936100866103a3565b50610099856100948361011b565b6103c0565b6100a16103a3565b9283916100ac6103a3565b50610164565b846102b0565b610316565b5160f81c6101f4565b005b600019920360031b610100031b01908119905116908251161790528480808080610067565b84518652948501949384019390880190610048565b60609150610032565b506060610019565b50606061000e565b61013490604051801561015c575b608001604052610204565b604051908115610153575b8161015091608082016040526103c0565b90565b6060915061013f565b506060610129565b61017c90604051801561015c57608001604052610204565b6040519081156101eb575b6080820160405280829160005b600481106101d557508103806080036101ae575b50505090565b60016000199160800360031b610100031b01908119905116908251161790523880806101a8565b8251845260209384019390920191600101610194565b60609150610187565b14156001146101ff57565b600080fd5b604080519182156102a7575b60209082840183526102228482610413565b0151818051801561029f575b01908115610296575b8282018352600082526020820152815190811561028d575b8161025e918482018552610413565b8151918215610284575b61027c838095608061015096018452610413565b830190610413565b60609250610268565b6060915061024f565b60609150610237565b50606061022e565b60609250610210565b906102d9604080805180156102ea575b01928382528181519480156102e2575b01825201610340565b019060f81b9052565b5060606102d0565b5060606102c0565b60009060405180158060011461030e571561030a5750565b9150565b506060925050565b61033c604080805180156102ea5701928382528181519480156102e25701825201610340565b0190565b9060009180516001810160016020840151018110928360011461039d5750505060001461036957565b6040518015610395575b80516001600160e01b0316634e487b7160e01b17815260016004820152602490fd5b506060610373565b52925050565b6040519081156103b7575b60808201604052565b606091506103ae565b8060005b600481106103fd57508103806080036103dc57505050565b60016000199160800360031b610100031b0190811990511690825116179052565b82518452602093840193909201916001016103c4565b8060005b60028110610450575081038060400361042f57505050565b60016000199160400360031b610100031b0190811990511690825116179052565b825184526020938401939092019160010161041756")) </jumpDests>

                    <id> ACCT_ID </id> // contract owner
                    <caller> CALLER_ID </caller> // who called this contract; in the beginning, origin // msg.sender

                    // todo: gen this part
                    <callData> #buf(32, ARG_0) </callData>

                    <callValue> 0 </callValue>
                    <wordStack> .WordStack => ?_ </wordStack>
                    <localMem> .Bytes => ?_ </localMem>
                    <pc> 0 => ?_ </pc>
                    <gas> #gas(_VGAS) => ?_ </gas>
                    <memoryUsed> 0 => ?_ </memoryUsed>
                    <callGas> _ => ?_ </callGas>

                    <static> false </static> // NOTE: non-static call
                    <callDepth> CALL_DEPTH </callDepth>
                </callState>

                <substate>
                    <selfDestruct> _ </selfDestruct>
                    <log> _ </log>
                    <refund> _ </refund>
                    <accessedAccounts> _ => ?_ </accessedAccounts>
                    <accessedStorage> _ => ?_ </accessedStorage>
                </substate>

                <gasPrice> _ </gasPrice>
                <origin> ORIGIN_ID </origin>

                <blockhashes> _ </blockhashes>
                <block>
                    <previousHash> _ </previousHash>
                    <ommersHash> _ </ommersHash>
                    <coinbase> _ </coinbase>
                    <stateRoot> _ </stateRoot>
                    <transactionsRoot> _ </transactionsRoot>
                    <receiptsRoot> _ </receiptsRoot>
                    <logsBloom> _ </logsBloom>
                    <difficulty> _ </difficulty>
                    <number> _ </number>
                    <gasLimit> _ </gasLimit>
                    <gasUsed> _ </gasUsed>
                    <timestamp> _ </timestamp>
                    <extraData> _ </extraData>
                    <mixHash> _ </mixHash>
                    <blockNonce> _ </blockNonce>
                    <ommerBlockHeaders> _ </ommerBlockHeaders>
                    <baseFee> _ </baseFee>
                </block>
            </evm>

            <network>
                <chainID> _ </chainID>

                <activeAccounts> SetItem(ACCT_ID) _:Set </activeAccounts>

                <accounts>
                    <account>
                        <acctID> ACCT_ID </acctID>
                        <balance> _ </balance>
                        <code> #parseByteStack("0x60003560409081518015610113575b82808201801561010b575b0183526100246102f2565b602090818101908115610102575b8582018652815260019485838301528184936000905b600282106100ed576100c6886100bd898989898f8a83038083036100c8575b50505050506100b86100946100b261007d6103a3565b936100866103a3565b50610099856100948361011b565b6103c0565b6100a16103a3565b9283916100ac6103a3565b50610164565b846102b0565b610316565b5160f81c6101f4565b005b600019920360031b610100031b01908119905116908251161790528480808080610067565b84518652948501949384019390880190610048565b60609150610032565b506060610019565b50606061000e565b61013490604051801561015c575b608001604052610204565b604051908115610153575b8161015091608082016040526103c0565b90565b6060915061013f565b506060610129565b61017c90604051801561015c57608001604052610204565b6040519081156101eb575b6080820160405280829160005b600481106101d557508103806080036101ae575b50505090565b60016000199160800360031b610100031b01908119905116908251161790523880806101a8565b8251845260209384019390920191600101610194565b60609150610187565b14156001146101ff57565b600080fd5b604080519182156102a7575b60209082840183526102228482610413565b0151818051801561029f575b01908115610296575b8282018352600082526020820152815190811561028d575b8161025e918482018552610413565b8151918215610284575b61027c838095608061015096018452610413565b830190610413565b60609250610268565b6060915061024f565b60609150610237565b50606061022e565b60609250610210565b906102d9604080805180156102ea575b01928382528181519480156102e2575b01825201610340565b019060f81b9052565b5060606102d0565b5060606102c0565b60009060405180158060011461030e571561030a5750565b9150565b506060925050565b61033c604080805180156102ea5701928382528181519480156102e25701825201610340565b0190565b9060009180516001810160016020840151018110928360011461039d5750505060001461036957565b6040518015610395575b80516001600160e01b0316634e487b7160e01b17815260016004820152602490fd5b506060610373565b52925050565b6040519081156103b7575b60808201604052565b606091506103ae565b8060005b600481106103fd57508103806080036103dc57505050565b60016000199160800360031b610100031b0190811990511690825116179052565b82518452602093840193909201916001016103c4565b8060005b60028110610450575081038060400361042f57505050565b60016000199160400360031b610100031b0190811990511690825116179052565b825184526020938401939092019160010161041756") </code>
                        <storage> _ </storage>
                        <origStorage> _ </origStorage>
                        <nonce> _ </nonce>
                    </account>
                </accounts>

                <txOrder> _ </txOrder>
                <txPending> _ </txPending>
                <messages> _ </messages>
            </network>
        </ethereum>
    </kevm>

    requires 0 <=Int ACCT_ID    andBool ACCT_ID    <Int (2 ^Int 160)
        andBool 0  <=Int CALLER_ID  andBool CALLER_ID  <Int (2 ^Int 160)
        andBool 0  <=Int ORIGIN_ID  andBool ORIGIN_ID  <Int (2 ^Int 160)
        andBool 0  <=Int CALL_DEPTH andBool CALL_DEPTH <Int 1024
        andBool 0 <=Int ARG_0 andBool ARG_0 <Int (2 ^Int 8)

endmodule

